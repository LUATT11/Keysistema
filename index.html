<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Redirigir a los Pasos</title>
  <style>
    body { font-family: Arial, sans-serif; background: #000; color: #fff; text-align: center; padding: 50px; }
    button { padding: 10px 20px; font-size: 16px; cursor: pointer; background-color: #28a745; color: white; border: none; border-radius: 5px; margin: 20px; }
    button:disabled { background-color: #ccc; }
    #reiniciarBtn { background-color: #dc3545; }
  </style>
</head>
<body>

  <h1>Selecciona un paso para continuar</h1>
  <button id="btnPaso1" onclick="verificarYRedirigir(1, 'https://direct-link.net/1258891/key-paso-1-gracias')">Ir al Paso 1</button>
  <button id="btnPaso2" onclick="verificarYRedirigir(2, 'https://link-hub.net/1258891/pagina-dos-key-2-completa')" disabled>Ir al Paso 2</button>
  <button id="btnPaso3" onclick="verificarYRedirigir(3, 'https://direct-link.net/1258891/bievenido')" disabled>Ir al Paso 3</button>
  <button id="btnPaso4" onclick="verificarYRedirigir(4, 'https://link-center.net/1258891/sistema-4')" disabled>Ir al Paso 4</button>
  <button id="btnPaso5" onclick="verificarYRedirigir(5, 'https://link-center.net/1258891/bivenido-al-ultimo')" disabled>Ir al Paso 5</button>

  <button id="reiniciarBtn" onclick="reiniciarPasos()">Reiniciar Todos los Pasos</button>

  <script>
    const API_TOKEN = 'b722f79f14db65b53df19cf69112ab156f8fab13482bbba3fba799b9fdf3fca1';

    async function verificarLinkvertise(url) {
      try {
        const response = await fetch(`https://publisher.linkvertise.com/api/v1/redirect/link/static/180849/${encodeURIComponent(url)}`, {
          headers: {
            'X-Linkvertise-Api-Key': API_TOKEN
          }
        });
        if (!response.ok) throw new Error('Verificación fallida');
        return true;
      } catch (error) {
        console.error('Error en la verificación:', error);
        return false;
      }
    }

    async function verificarYRedirigir(paso, url) {
      const verificado = await verificarLinkvertise(url);
      localStorage.setItem(`Verificacion${paso}`, verificado ? 'true' : 'false');
      Web(paso, url);
    }

    function Web(paso, url) {
      localStorage.setItem(`Verificacion${paso}`, 'true');
      window.open(url, '_blank');
    }

    function verificarEstado() {
      setInterval(() => {
        for (let i = 1; i <= 5; i++) {
          const btnElement = document.getElementById(`btnPaso${i}`);
          if (localStorage.getItem(`Paso${i}`) === 'true') {
            if (i < 5) document.getElementById(`btnPaso${i+1}`).disabled = false;
            btnElement.style.display = 'none';
          } else {
            btnElement.style.display = 'inline-block';
          }
        }

        if (localStorage.getItem('Paso1') === 'true' && 
            localStorage.getItem('Paso2') === 'true' && 
            localStorage.getItem('Paso3') === 'true' && 
            localStorage.getItem('Paso4') === 'true' && 
            localStorage.getItem('Paso5') === 'true') {
          window.location.href = "generate.html";
        }
      }, 1000);
    }

    function reiniciarPasos() {
      for (let i = 1; i <= 5; i++) {
        localStorage.removeItem(`Verificacion${i}`);
        localStorage.removeItem(`Paso${i}`);
        const btnElement = document.getElementById(`btnPaso${i}`);
        btnElement.style.display = 'inline-block';
        if (i > 1) btnElement.disabled = true;
      }
    }

    verificarEstado();
  </script>

</body>
</html>

